# Copyright (c) OpenMMLab. All rights reserved.
import pytest
import torch
import torch.nn.functional as F

from mmseg.models import build_loss


# test focal loss with use_sigmoid=False
def test_use_sigmoid():
    # can't init with use_sigmoid=True
    with pytest.raises(AssertionError):
        loss_cfg = dict(type='FocalLoss', use_sigmoid=False)
        build_loss(loss_cfg)

    # can't forward with use_sigmoid=True
    with pytest.raises(NotImplementedError):
        loss_cfg = dict(type='FocalLoss', use_sigmoid=True)
        focal_loss = build_loss(loss_cfg)
        focal_loss.use_sigmoid = False
        fake_pred = torch.rand(3, 4, 5, 6)
        fake_target = torch.randint(0, 4, (3, 5, 6))
        focal_loss(fake_pred, fake_target)


# reduction type must be 'none', 'mean' or 'sum'
def test_wrong_reduction_type():
    # can't init with wrong reduction
    with pytest.raises(AssertionError):
        loss_cfg = dict(type='FocalLoss', reduction='test')
        build_loss(loss_cfg)

    # can't forward with wrong reduction override
    with pytest.raises(AssertionError):
        loss_cfg = dict(type='FocalLoss')
        focal_loss = build_loss(loss_cfg)
        fake_pred = torch.rand(3, 4, 5, 6)
        fake_target = torch.randint(0, 4, (3, 5, 6))
        focal_loss(fake_pred, fake_target, reduction_override='test')


# test focal loss can handle input parameters with
# unacceptable types
def test_unacceptable_parameters():
    with pytest.raises(AssertionError):
        loss_cfg = dict(type='FocalLoss', gamma='test')
        build_loss(loss_cfg)
    with pytest.raises(AssertionError):
        loss_cfg = dict(type='FocalLoss', alpha='test')
        build_loss(loss_cfg)
    with pytest.raises(AssertionError):
        loss_cfg = dict(type='FocalLoss', class_weight='test')
        build_loss(loss_cfg)
    with pytest.raises(AssertionError):
        loss_cfg = dict(type='FocalLoss', loss_weight='test')
        build_loss(loss_cfg)
    with pytest.raises(AssertionError):
        loss_cfg = dict(type='FocalLoss', loss_name=123)
        build_loss(loss_cfg)


# test if focal loss can be correctly initialize
def test_init_focal_loss():
    loss_cfg = dict(
        type='FocalLoss',
        use_sigmoid=True,
        gamma=3.0,
        alpha=3.0,
        class_weight=[1, 2, 3, 4],
        reduction='sum')
    focal_loss = build_loss(loss_cfg)
    assert focal_loss.use_sigmoid is True
    assert focal_loss.gamma == 3.0
    assert focal_loss.alpha == 3.0
    assert focal_loss.reduction == 'sum'
    assert focal_loss.class_weight == [1, 2, 3, 4]
    assert focal_loss.loss_weight == 1.0
    assert focal_loss.loss_name == 'loss_focal'


# test reduction override
def test_reduction_override():
    loss_cfg = dict(type='FocalLoss', reduction='mean')
    focal_loss = build_loss(loss_cfg)
    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    loss = focal_loss(fake_pred, fake_target, reduction_override='none')
    assert loss.shape == fake_pred.shape


# test wrong pred and target shape
def test_wrong_pred_and_target_shape():
    loss_cfg = dict(type='FocalLoss')
    focal_loss = build_loss(loss_cfg)
    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 2, 2))
    fake_target = F.one_hot(fake_target, num_classes=4)
    fake_target = fake_target.permute(0, 3, 1, 2)
    with pytest.raises(AssertionError):
        focal_loss(fake_pred, fake_target)


# test forward with different shape of target
def test_forward_with_different_shape_of_target():
    loss_cfg = dict(type='FocalLoss')
    focal_loss = build_loss(loss_cfg)

    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    loss1 = focal_loss(fake_pred, fake_target)

    fake_target = F.one_hot(fake_target, num_classes=4)
    fake_target = fake_target.permute(0, 3, 1, 2)
    loss2 = focal_loss(fake_pred, fake_target)
    assert loss1 == loss2


# test forward with weight
def test_forward_with_weight():
    loss_cfg = dict(type='FocalLoss')
    focal_loss = build_loss(loss_cfg)
    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    weight = torch.rand(3 * 5 * 6, 1)
    loss1 = focal_loss(fake_pred, fake_target, weight=weight)

    weight2 = weight.view(-1)
    loss2 = focal_loss(fake_pred, fake_target, weight=weight2)

    weight3 = weight.expand(3 * 5 * 6, 4)
    loss3 = focal_loss(fake_pred, fake_target, weight=weight3)
    assert loss1 == loss2 == loss3


# test none reduction type
def test_none_reduction_type():
    loss_cfg = dict(type='FocalLoss', reduction='none')
    focal_loss = build_loss(loss_cfg)
    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    loss = focal_loss(fake_pred, fake_target)
    assert loss.shape == fake_pred.shape


# test the usage of class weight
def test_class_weight():
    loss_cfg_cw = dict(
        type='FocalLoss', reduction='none', class_weight=[1.0, 2.0, 3.0, 4.0])
    loss_cfg = dict(type='FocalLoss', reduction='none')
    focal_loss_cw = build_loss(loss_cfg_cw)
    focal_loss = build_loss(loss_cfg)
    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    loss_cw = focal_loss_cw(fake_pred, fake_target)
    loss = focal_loss(fake_pred, fake_target)
    weight = torch.tensor([1, 2, 3, 4]).view(1, 4, 1, 1)
    assert (loss * weight == loss_cw).all()


# test ignore index
def test_ignore_index():
    loss_cfg = dict(type='FocalLoss', reduction='none')
    # ignore_index within C classes
    focal_loss = build_loss(loss_cfg)
    fake_pred = torch.rand(3, 5, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    dim1 = torch.randint(0, 3, (4, ))
    dim2 = torch.randint(0, 5, (4, ))
    dim3 = torch.randint(0, 6, (4, ))
    fake_target[dim1, dim2, dim3] = 4
    loss1 = focal_loss(fake_pred, fake_target, ignore_index=4)
    one_hot_target = F.one_hot(fake_target, num_classes=5)
    one_hot_target = one_hot_target.permute(0, 3, 1, 2)
    loss2 = focal_loss(fake_pred, one_hot_target, ignore_index=4)
    assert (loss1 == loss2).all()
    assert (loss1[dim1, :, dim2, dim3] == 0).all()
    assert (loss2[dim1, :, dim2, dim3] == 0).all()

    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    loss1 = focal_loss(fake_pred, fake_target, ignore_index=2)
    one_hot_target = F.one_hot(fake_target, num_classes=4)
    one_hot_target = one_hot_target.permute(0, 3, 1, 2)
    loss2 = focal_loss(fake_pred, one_hot_target, ignore_index=2)
    ignore_mask = one_hot_target == 2
    assert (loss1 == loss2).all()
    assert torch.sum(loss1 * ignore_mask) == 0
    assert torch.sum(loss2 * ignore_mask) == 0

    # ignore index is not in prediction's classes
    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    dim1 = torch.randint(0, 3, (4, ))
    dim2 = torch.randint(0, 5, (4, ))
    dim3 = torch.randint(0, 6, (4, ))
    fake_target[dim1, dim2, dim3] = 255
    loss1 = focal_loss(fake_pred, fake_target, ignore_index=255)
    assert (loss1[dim1, :, dim2, dim3] == 0).all()


# test list alpha
def test_alpha():
    loss_cfg = dict(type='FocalLoss')
    focal_loss = build_loss(loss_cfg)
    alpha_float = 0.4
    alpha = [0.4, 0.4, 0.4, 0.4]
    alpha2 = [0.1, 0.3, 0.2, 0.1]
    fake_pred = torch.rand(3, 4, 5, 6)
    fake_target = torch.randint(0, 4, (3, 5, 6))
    focal_loss.alpha = alpha_float
    loss1 = focal_loss(fake_pred, fake_target)
    focal_loss.alpha = alpha
    loss2 = focal_loss(fake_pred, fake_target)
    assert loss1 == loss2
    focal_loss.alpha = alpha2
    focal_loss(fake_pred, fake_target)


# test whether cpu version and gpu version are the same
def test_same():
    loss_cfg = dict(type='FocalLoss')
    focal_loss = build_loss(loss_cfg)
    fake_pred = torch.tensor([[[[0.1998772621, 0.3659250736],
                                [0.9128918052, 0.2723454833]],
                               [[0.1373604536, 0.2495964766],
                                [0.9785252810, 0.5094971061]],
                               [[0.2959728837, 0.8378278613],
                                [0.5674484372, 0.3124643564]]],
                              [[[0.2381041050, 0.8065491915],
                                [0.2052971125, 0.9496635199]],
                               [[0.2494341135, 0.9726386070],
                                [0.9316667318, 0.2813754082]],
                               [[0.2399672866, 0.3493354321],
                                [0.9550838470, 0.8279340863]]]])
    fake_target = torch.tensor([[[2, 2], [1, 2]], [[0, 1], [2, 0]]])
    fake_target_one_hot = torch.tensor([[[[0, 0], [0, 0]], [[0, 0], [1, 0]],
                                         [[1, 1], [0, 1]]],
                                        [[[1, 0], [0, 1]], [[0, 1], [0, 0]],
                                         [[0, 0], [1, 0]]]])
    gpu_results = [
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[3.154235659167e-03, 4.470038227737e-03],
                        [7.556425873190e-03, 4.038503859192e-03]],
                       [[1.654161140323e-03, 3.438753634691e-02],
                        [1.980140106753e-03, 6.114346906543e-02]],
                       [[1.986406743526e-02, 2.876800950617e-03],
                        [3.475922346115e-02, 7.408759556711e-03]]],
                      [[[6.621975335293e-04, 5.068928934634e-03],
                        [3.801103215665e-03, 1.346173667116e-04]],
                       [[1.120079588145e-02, 1.886526471935e-03],
                        [2.504604868591e-02, 2.119205333292e-02]],
                       [[3.766115009785e-02, 6.910999864340e-02],
                        [3.804825479165e-03, 1.751711219549e-01]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.059606619179, 0.084471762180],
                        [0.142796248198, 0.076316922903]],
                       [[0.006033900660, 0.125435769558],
                        [0.007222977001, 0.223033651710]],
                       [[0.038117032498, 0.005520274397],
                        [0.066699251533, 0.014216620475]]],
                      [[[0.012513762340, 0.095789201558],
                        [0.071830689907, 0.002543908311]],
                       [[0.040857259184, 0.006881501991],
                        [0.091360732913, 0.077302463353]],
                       [[0.072267733514, 0.132614731789],
                        [0.007301054895, 0.336134761572]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.003327343147, 0.008754276671],
                        [0.014864205383, 0.004348234273]],
                       [[0.015587150119, 0.038009084761],
                        [0.001920080394, 0.031880151480]],
                       [[0.009161217138, 0.006054337136],
                        [0.095189787447, 0.010355100036]]],
                      [[[0.001270386856, 0.002549630357],
                        [0.004466296639, 0.000395179290]],
                       [[0.022804837674, 0.000378258264],
                        [0.061850164086, 0.033063568175]],
                       [[0.042715311050, 0.013569413684],
                        [0.003028875915, 0.132248163223]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.062877893448, 0.165432423353],
                        [0.280893743038, 0.082169994712]],
                       [[0.056857403368, 0.138646125793],
                        [0.007003896870, 0.116289556026]],
                       [[0.017579400912, 0.011617627926],
                        [0.182659059763, 0.019870333374]]],
                      [[[0.024006914347, 0.048181194812],
                        [0.084401063621, 0.007467831951]],
                       [[0.083185441792, 0.001379776397],
                        [0.225611463189, 0.120606310666]],
                       [[0.081966139376, 0.026038259268],
                        [0.005812090356, 0.253770142794]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.007659629919, 0.009882904589],
                        [0.020215157419, 0.008579783142]],
                       [[0.035882022232, 0.042909331620],
                        [0.002611288568, 0.062904797494]],
                       [[0.021089360118, 0.006834879983],
                        [0.129457071424, 0.020432321355]]],
                      [[[0.002389742061, 0.017842058092],
                        [0.007725819480, 0.000538684952]],
                       [[0.042898491025, 0.002647013403],
                        [0.106988683343, 0.045070294291]],
                       [[0.080352358520, 0.094957403839],
                        [0.005239363294, 0.180272847414]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        torch.tensor([[[[0.144746527076, 0.186760470271],
                        [0.382012426853, 0.162134960294]],
                       [[0.130887210369, 0.156520798802],
                        [0.009525223635, 0.229458481073]],
                       [[0.040468234569, 0.013115406968],
                        [0.248414337635, 0.039207447320]]],
                      [[[0.045159734786, 0.337167203426],
                        [0.145997330546, 0.010179704987]],
                       [[0.156481266022, 0.009655538015],
                        [0.390263706446, 0.164403364062]],
                       [[0.154187619686, 0.182213142514],
                        [0.010053779930, 0.345924407244]]]]),
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.022418031468987465,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.0748695433139801,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.02324129454791546,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.08768016844987869,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.039807554334402084,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.15395577251911163,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        0.5380327701568604,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        1.7968690395355225,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        0.5577910542488098,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        2.1043241024017334,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        0.9553812742233276,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
        3.6949386596679688,
    ]
    weights = [
        torch.tensor([[0.4118, 0.0461, 0.9419], [0.4523, 0.8014, 0.4209],
                      [0.3738, 0.7583, 0.2685], [0.4707, 0.9720, 0.3626],
                      [0.2771, 0.2611, 0.4687], [0.2841, 0.7127, 0.7278],
                      [0.4920, 0.2341, 0.7262], [0.2499, 0.4702, 0.9717]]),
        torch.tensor(
            [0.4344, 0.8858, 0.7353, 0.5068, 0.5316, 0.1429, 0.5781, 0.7336]),
        None
    ]
    class_weights = [[
        0.052917540073394775, 0.27414458990097046, 0.5211336612701416
    ], None]
    ignore_indexes = [255, 4]
    index = 0
    for reduce in ['none', 'mean', 'sum']:
        for weight in weights:
            for class_weight in class_weights:
                for target in [fake_target, fake_target_one_hot]:
                    for ignore_index in ignore_indexes:
                        for alpha in [[0.4] * 3, 0.4, [0.4] * 3, 0.4]:
                            gpu_result = gpu_results[index]
                            if isinstance(gpu_result, float):
                                gpu_result = torch.tensor(gpu_result)
                            index += 1
                            focal_loss.class_weight = class_weight
                            focal_loss.alpha = alpha
                            cpu_result = focal_loss(
                                fake_pred,
                                target,
                                weight=weight,
                                ignore_index=ignore_index,
                                reduction_override=reduce)
                            assert torch.allclose(cpu_result, gpu_result)
